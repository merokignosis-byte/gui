===== ./hardening_scripts/firewall.sh =====

Checking: Ensure ufw is installed
Rule ID: FW-UFW-INST
[0;32m[PASS][0m ufw is installed

Checking: Ensure iptables-persistent is not installed with ufw
Rule ID: FW-UFW-IPTPERS
[0;32m[PASS][0m iptables-persistent is not installed

Checking: Ensure ufw service is enabled
Rule ID: FW-UFW-SVC
[0;32m[PASS][0m ufw service is enabled

Checking: Ensure ufw loopback traffic is configured
Rule ID: FW-UFW-LOOP
[0;31m[FAIL][0m Missing UFW loopback rules

Checking: Ensure UFW outbound connections are allowed
Rule ID: FW-UFW-OUT
[1;33m[WARN][0m Outbound connections must be manually reviewed

Checking: Ensure UFW firewall rules exist for all open ports
Rule ID: FW-UFW-PORTS
[1;33m[WARN][0m Adding missing UFW rule for port: 323
[0;31m[FAIL][0m Failed to add UFW rule for port: 323
[1;33m[WARN][0m Adding missing UFW rule for port: 5000
[0;31m[FAIL][0m Failed to add UFW rule for port: 5000
ERROR: You need to be root to run this script
[0;32m[INFO][0m UFW reloaded after adding missing rules.
[1;33m[WARN][0m Some open ports rules were added

Checking: Ensure UFW default deny firewall policy
Rule ID: FW-UFW-DENY
ERROR: You need to be root to run this script
[0;31m[FAIL][0m Default deny incoming policy NOT active

Checking: Ensure UFW is not in use with raw iptables
Rule ID: FW-UFW-CONFLICT
iptables v1.8.11 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)
[0;32m[PASS][0m No UFW/iptables conflict detected

===== Firewall Hardening Summary =====
Total checks : 8
Passed       : 4
Failed       : 4
Fixed        : 0
===== ./hardening_scripts/logging_auditing.sh =====
========================================================================
Logging and Auditing Hardening Script - Enhanced Version
Mode: scan
========================================================================
[0;32m[INFO][0m === System Logging - journald ===

Checking: Ensure journald service is enabled and active
Rule ID: LOG-JOURNALD-ENABLED
[0;32m[PASS][0m journald is active

Checking: Ensure journald log file rotation is configured
Rule ID: LOG-JOURNALD-COMPRESS
[0;32m[PASS][0m journald rotation is configured

Checking: Ensure journald is configured to persist logs to disk
Rule ID: LOG-JOURNALD-PERSIST
[0;32m[PASS][0m journald persistent storage is configured
[0;32m[INFO][0m 
[0;32m[INFO][0m === System Logging - rsyslog ===

Checking: Ensure rsyslog is installed
Rule ID: LOG-RSYSLOG-INSTALLED
[0;32m[PASS][0m rsyslog is installed

Checking: Ensure rsyslog service is enabled and active
Rule ID: LOG-RSYSLOG-ENABLED
[1;33m[WARN][0m rsyslog service is masked (systemd-journald is being used)

Checking: Ensure rsyslog default file permissions are configured
Rule ID: LOG-RSYSLOG-DEFPERMS
[0;32m[PASS][0m rsyslog file creation mode is configured (0640)

Checking: Ensure rsyslog is configured to send logs to remote host
Rule ID: LOG-RSYSLOG-REMOTE
[1;33m[WARN][0m rsyslog remote logging not configured (manual setup required)

Checking: Ensure logrotate is configured
Rule ID: LOG-LOGROTATE
[0;32m[PASS][0m logrotate is configured

Checking: Ensure permissions on all logfiles are configured
Rule ID: LOG-FILE-PERMS
[0;31m[FAIL][0m Found 1 log files with incorrect permissions
[0;32m[INFO][0m 
[0;32m[INFO][0m === System Auditing - auditd ===

Checking: Ensure auditd is installed
Rule ID: AUD-AUDITD-INSTALLED
[0;32m[PASS][0m auditd is installed

Checking: Ensure auditd service is enabled and running
Rule ID: AUD-AUDITD-ENABLED
[0;32m[PASS][0m auditd is enabled and active

Checking: Ensure auditing for processes prior to auditd is enabled
Rule ID: AUD-BOOT-PARAMS
[0;31m[FAIL][0m Boot parameter audit=1 is not set

Checking: Ensure audit_backlog_limit is sufficient
Rule ID: AUD-BACKLOG-LIMIT
[0;31m[FAIL][0m audit_backlog_limit not set or insufficient (current: not set)

Checking: Ensure audit log storage size is configured
Rule ID: AUD-LOG-STORAGE

Checking: Ensure system is disabled when audit logs are full
Rule ID: AUD-DISK-FULL

Checking: Ensure audit rules are configured
Rule ID: AUD-RULES
[0;31m[FAIL][0m Custom audit rules not configured

Checking: Ensure audit configuration is immutable
Rule ID: AUD-IMMUTABLE
[1;33m[WARN][0m Audit configuration is not immutable
[0;32m[INFO][0m 
[0;32m[INFO][0m === Integrity Checking - AIDE ===

Checking: Ensure AIDE is installed
Rule ID: AUD-AIDE-INSTALLED
[0;32m[PASS][0m AIDE is installed
./hardening_scripts/logging_auditing.sh: line 1206: check_aide_config: command not found

========================================================================
Summary
========================================================================
Total Checks: 18
Passed: 9
Failed: 7
[1;33m[WARN][0m 7 checks failed. Run with 'fix' mode to remediate.
===== ./hardening_scripts/network.sh =====

Checking: Ensure IPv6 status is identified
Rule ID: NET-DEVC-IPv6
[0;32m[PASS][0m IPv6 status: disable_ipv6=0

Checking: Ensure wireless interfaces are disabled
Rule ID: NET-DEVC-WIFI
[0;32m[PASS][0m No wireless interfaces detected.

Checking: Ensure Bluetooth service is not in use
Rule ID: NET-DEVC-BLUETOOTH
[0;32m[PASS][0m Bluetooth service is disabled

Checking: Ensure dccp kernel module is not available
Rule ID: NET-MOD-DCCP
[0;32m[PASS][0m Module dccp is blacklisted

Checking: Ensure tipc kernel module is not available
Rule ID: NET-MOD-TIPC
[0;32m[PASS][0m Module tipc is blacklisted

Checking: Ensure rds kernel module is not available
Rule ID: NET-MOD-RDS
[0;32m[PASS][0m Module rds is blacklisted

Checking: Ensure sctp kernel module is not available
Rule ID: NET-MOD-SCTP
[0;32m[PASS][0m Module sctp is blacklisted

Checking: Ensure IP forwarding is disabled
Rule ID: NET-PAR-FWD
[0;32m[PASS][0m net.ipv4.ip_forward is correctly set to 0

Checking: Ensure packet redirect sending is disabled
Rule ID: NET-PAR-REDIR
[0;32m[PASS][0m net.ipv4.conf.all.send_redirects is correctly set to 0

Checking: Ensure bogus ICMP responses are ignored
Rule ID: NET-PAR-BOGUS
[0;32m[PASS][0m net.ipv4.icmp_ignore_bogus_error_responses is correctly set to 1

Checking: Ensure broadcast ICMP requests are ignored
Rule ID: NET-PAR-BCAST
[0;32m[PASS][0m net.ipv4.icmp_echo_ignore_broadcasts is correctly set to 1

Checking: Ensure ICMP redirects are not accepted
Rule ID: NET-PAR-ICMPRED
[0;32m[PASS][0m net.ipv4.conf.all.accept_redirects is correctly set to 0

Checking: Ensure secure ICMP redirects are not accepted
Rule ID: NET-PAR-SREDIR
[0;32m[PASS][0m net.ipv4.conf.all.secure_redirects is correctly set to 0

Checking: Ensure reverse path filtering is enabled
Rule ID: NET-PAR-RPF
[0;32m[PASS][0m net.ipv4.conf.all.rp_filter is correctly set to 1

Checking: Ensure source routed packets are not accepted
Rule ID: NET-PAR-SROUTE
[0;32m[PASS][0m net.ipv4.conf.all.accept_source_route is correctly set to 0

Checking: Ensure suspicious packets are logged
Rule ID: NET-PAR-MART
[0;31m[FAIL][0m net.ipv4.conf.all.log_martians is 0 (expected 1)

Checking: Ensure TCP SYN cookies are enabled
Rule ID: NET-PAR-SYNC
[0;32m[PASS][0m net.ipv4.tcp_syncookies is correctly set to 1

Checking: Ensure IPv6 router advertisements are not accepted
Rule ID: NET-PAR-RA
[0;32m[PASS][0m net.ipv6.conf.all.accept_ra is correctly set to 0

========================================================================
Network Hardening Summary
========================================================================
Total Checks: 18
Passed: 17
Failed: 1
Fixed:  0
========================================================================
[0;31m[FAIL] Some checks failed.[0m
===== ./hardening_scripts/package_mgmt.sh =====
[0;32m[INFO][0m Starting GRUB security hardening...
chown: changing ownership of '/boot/grub/grub.cfg': Operation not permitted
chmod: changing permissions of '/boot/grub/grub.cfg': Operation not permitted
[0;32m[INFO][0m GRUB config permissions set to 400 root:root

Checking: Ensure bootloader password is set
[0;31m[FAIL][0m Bootloader password is not set

Checking: Ensure access to bootloader config is restricted
[0;32m[PASS][0m Bootloader config permissions correct

Checking: Ensure ASLR is enabled
[0;32m[PASS][0m ASLR is enabled

Checking: Ensure ptrace_scope is restricted
[0;32m[PASS][0m ptrace_scope is restricted (1)

Checking: Ensure core dumps are restricted
[0;32m[PASS][0m Core dumps are restricted

Checking: Ensure prelink is not installed
[0;32m[PASS][0m prelink not installed

Checking: Ensure Automatic Error Reporting is not enabled
[0;32m[PASS][0m Apport is disabled

Checking: Ensure local login warning banner is configured properly
[0;32m[PASS][0m /etc/issue banner configured

Checking: Ensure remote login warning banner is configured properly
[0;32m[PASS][0m /etc/issue.net banner configured

Checking: Ensure GPG keys are configured for package management
[0;32m[PASS][0m APT GPG keyrings are configured

Checking: Ensure package repositories use secure protocols (HTTPS)
[0;32m[PASS][0m All package repositories use HTTPS or secure protocols

Checking: Ensure unattended-upgrades is enabled
[0;32m[PASS][0m unattended-upgrades is enabled

========================================================================
Package Management Hardening Summary
========================================================================
Total Checks: 12
Passed: 11
Failed: 1
Fixed: 0
========================================================================
[0;31m[FAIL] Some checks failed. See above for details.[0m
===== ./hardening_scripts/services.sh =====

Checking: Disable autofs
[0;32m[PASS][0m autofs is disabled

Checking: Disable avahi-daemon
[0;32m[PASS][0m avahi-daemon is disabled

Checking: Disable DHCP server
[0;32m[PASS][0m isc-dhcp-server is disabled

Checking: Disable DNS server (bind9)
[0;32m[PASS][0m bind9 is disabled

Checking: Disable dnsmasq
[0;32m[PASS][0m dnsmasq is disabled

Checking: Disable FTP server
[0;32m[PASS][0m vsftpd is disabled

Checking: Disable LDAP server
[0;32m[PASS][0m slapd is disabled

Checking: Disable Dovecot (IMAP/POP3)
[0;32m[PASS][0m dovecot is disabled

Checking: Disable NFS server
[0;32m[PASS][0m nfs-kernel-server is disabled

Checking: Disable NIS server
[0;32m[PASS][0m nis is disabled

Checking: Disable Cups printing service
[0;32m[PASS][0m cups is disabled

Checking: Disable rpcbind
[0;32m[PASS][0m rpcbind is disabled

Checking: Disable rsync daemon
[0;32m[PASS][0m rsync is disabled

Checking: Disable Samba
[0;32m[PASS][0m smbd is disabled

Checking: Disable snmp daemon
[0;32m[PASS][0m snmpd is disabled

Checking: Disable tftp server
[0;32m[PASS][0m tftpd-hpa is disabled

Checking: Disable Squid proxy
[0;32m[PASS][0m squid is disabled

Checking: Disable Apache2 web server
[0;32m[PASS][0m apache2 is disabled

Checking: Disable xinetd
[0;32m[PASS][0m xinetd is disabled

Checking: Disable GDM (GUI login manager)
[0;32m[PASS][0m gdm is disabled

Checking: Disable Postfix MTA
[0;32m[PASS][0m postfix is disabled

Checking: Disable NFS common
[0;32m[PASS][0m nfs-common is disabled

Checking: Disable Telnet server
[0;32m[PASS][0m telnetd is disabled

Checking: Disable rsh server
[0;32m[PASS][0m rsh-server is disabled

Checking: Disable talk server
[0;32m[PASS][0m talkd is disabled

Checking: Disable nscd service
[0;32m[PASS][0m nscd is disabled

Checking: Disable ntpdate service
[0;32m[PASS][0m ntpdate is disabled

Checking: Disable LPD printing service
[0;32m[PASS][0m lpd is disabled

Checking: Disable rsyslog
[0;32m[PASS][0m rsyslog is disabled

Checking: Remove NIS client
[0;31m[FAIL][0m nis installed

Checking: Remove rsh client
[0;32m[PASS][0m rsh-client not installed

Checking: Remove talk client
[0;32m[PASS][0m talk not installed

Checking: Remove telnet client
[0;31m[FAIL][0m telnet installed

Checking: Remove ftp client
[0;31m[FAIL][0m ftp installed

Checking: Remove ldap-utils
[0;32m[PASS][0m ldap-utils not installed

Checking: Time Sync â€” only chrony allowed
[0;32m[PASS][0m Chrony active

Checking: Only approved ports open
[0;31m[FAIL][0m Unauthorized:  323 323 5000

Checking: Only approved services are listening on a network interface
[0;31m[FAIL][0m Unauthorized services:  udp udp tcp

Checking: Ensure rsyslog is running and disabled for remote logging
[0;32m[PASS][0m rsyslog active and local-only

Checking: Ensure NFS client is not installed
[0;32m[PASS][0m NFS client not installed

Checking: Mail server configured for local-only mode
[0;32m[PASS][0m Mail server local-only

========================================================
Summary
========================================================
Total Checks: 41
Passed: 36
Failed: 5
Fixed: 0
========================================================
[0;31m[FAIL] Issues detected.[0m
===== ./hardening_scripts/system_maintenance.sh =====
Database initialized or already exists.
[0;32m[PASS][0m /etc/passwd permissions correct (644)
[0;32m[PASS][0m /etc/passwd- permissions correct (644)
[0;32m[PASS][0m /etc/group permissions correct (644)
[0;32m[PASS][0m /etc/group- permissions correct (644)
[0;32m[PASS][0m /etc/shadow permissions correct (640)
[0;31m[FAIL][0m /etc/shadow- permissions 640 (expected: 600)
[0;32m[PASS][0m /etc/gshadow permissions correct (640)
[0;31m[FAIL][0m /etc/gshadow- permissions 640 (expected: 600)
[0;32m[PASS][0m /etc/shells permissions correct (644)
[0;32m[PASS][0m /etc/security/opasswd permissions correct (600)
[0;32m[PASS][0m All accounts use shadow passwords
awk: fatal: cannot open file `/etc/shadow' for reading: Permission denied
[0;32m[PASS][0m No empty password fields
[0;32m[PASS][0m No duplicate UIDs (real users)
[0;32m[PASS][0m No duplicate GIDs (real users)
[0;32m[PASS][0m No duplicate usernames
[0;32m[PASS][0m No duplicate group names
[0;32m[INFO][0m All real user home directories under /home
[0;32m[PASS][0m No dangerous dotfile permissions
[0;32m[PASS][0m No unsafe world-writable files
[0;32m[PASS][0m All system files have valid owners/groups
[0;32m[INFO][0m SUID files found: 33
[0;32m[INFO][0m SGID files found: 20
[0;32m[PASS][0m All users have valid shells
[0;32m[PASS][0m sudoers file exists
[0;32m[PASS][0m opasswd file exists
[0;32m[PASS][0m hosts.allow exists
[0;32m[PASS][0m hosts.deny exists

==================== Summary ====================
Total Checks : 24
Passed       : 22
Failed       : 2
Fixed        : 0
=================================================
[0;31m[FAIL] Issues detected.[0m
