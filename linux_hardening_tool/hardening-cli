#!/bin/bash
###############################################################################
# Linux Hardening Tool - CLI Launcher
# Easy-to-use wrapper for the hardening controller
###############################################################################

# Get script directory
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'

# Banner
echo -e "${BLUE}=========================================${NC}"
echo -e "${GREEN}ðŸ”’ Linux System Hardening Tool - CLI${NC}"
echo -e "${BLUE}=========================================${NC}"
echo ""

# Check if running as root
if [ "$EUID" -ne 0 ]; then
    echo -e "${RED}[ERROR]${NC} This tool must be run as root!"
    echo -e "${GREEN}[INFO]${NC}  Use: sudo ./hardening-cli"
    echo ""
    echo -e "${YELLOW}[TIP]${NC}   Scan operations may work without root,"
    echo "       but fix and rollback require root privileges."
    echo ""
    exit 1
fi

# Check if controller exists
if [ ! -f "$SCRIPT_DIR/hardening_controller.py" ]; then
    echo -e "${RED}[ERROR]${NC} hardening_controller.py not found!"
    echo -e "${GREEN}[INFO]${NC}  Please run: sudo python3 install.py"
    echo ""
    exit 1
fi

# Change to script directory
cd "$SCRIPT_DIR" || exit 1

# Check for command line arguments
if [ $# -gt 0 ]; then
    # Direct command mode
    echo -e "${GREEN}[INFO]${NC} Running command: $*"
    echo ""
    exec python3 hardening_controller.py "$@"
else
    # Interactive mode
    echo -e "${GREEN}[INFO]${NC} Starting interactive mode..."
    echo ""
    exec python3 hardening_controller.py
fi
